# Friday 2.0 - Environment Variables Template
# Copy this file to .env and fill in your actual values

# ============================================================================
# CRITICAL: Never commit .env to git - use SOPS for encrypted secrets
# ============================================================================

# ----------------------------------------------------------------------------
# PostgreSQL
# ----------------------------------------------------------------------------
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=friday_db
POSTGRES_USER=friday
POSTGRES_PASSWORD=changeme_strong_password_here

# URL complÃ¨te PostgreSQL (utilisÃ©e par agents et services)
DATABASE_URL=postgresql://friday:changeme_strong_password_here@postgres:5432/friday_db

# ----------------------------------------------------------------------------
# Redis
# ----------------------------------------------------------------------------
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=changeme_redis_password

# URL complÃ¨te Redis (utilisÃ©e par agents et services)
REDIS_URL=redis://:changeme_redis_password@redis:6379/0

# Redis ACL per-service passwords (see config/redis.acl)
REDIS_ADMIN_PASSWORD=friday_admin_dev
REDIS_GATEWAY_PASSWORD=friday_gw_dev
REDIS_AGENTS_PASSWORD=friday_ag_dev
REDIS_ALERTING_PASSWORD=friday_al_dev
REDIS_METRICS_PASSWORD=friday_mt_dev
REDIS_N8N_PASSWORD=friday_n8_dev
REDIS_EMAILENGINE_PASSWORD=friday_ee_dev

# ----------------------------------------------------------------------------
# FastAPI Gateway
# ----------------------------------------------------------------------------
API_HOST=0.0.0.0
API_PORT=8000
API_TOKEN=changeme_api_token_min_32_chars  # Bearer token auth (SOPS encrypted)
SECRET_KEY=changeme_secret_key_min_32_chars

# ----------------------------------------------------------------------------
# Anthropic API - Claude Sonnet 4.5 (D17)
# ----------------------------------------------------------------------------
ANTHROPIC_API_KEY=your_anthropic_api_key_here
LLM_PROVIDER=anthropic
LLM_MODEL=claude-sonnet-4-5-20250929

# Budget estime : ~45 EUR/mois API
# Tarification : $3/$15 per 1M tokens (input/output)

# ----------------------------------------------------------------------------
# Memorystore (D19 - pgvector dans PostgreSQL Day 1)
# ----------------------------------------------------------------------------
MEMORYSTORE_PROVIDER=pg_pgvector  # pgvector Day 1, graphiti si reevaluation aout 2026
# Note: pgvector integre dans PostgreSQL, pas de config vectorstore separee

# ----------------------------------------------------------------------------
# n8n (Workflows)
# ----------------------------------------------------------------------------
N8N_HOST=n8n.friday.local
# n8n v2 : basic auth supprime, owner cree via UI au premier acces
# Voir: https://docs.n8n.io/hosting/authentication/
N8N_ENCRYPTION_KEY=changeme_n8n_encryption_key_min_32_chars

# ----------------------------------------------------------------------------
# Telegram Bot
# ----------------------------------------------------------------------------
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here  # Token du bot (@BotFather)
TELEGRAM_SUPERGROUP_ID=-1001234567890  # ID du supergroup (nombre nÃ©gatif)
ANTONIO_USER_ID=123456789  # ID utilisateur Antonio (nombre positif)

# Thread IDs pour les 5 topics (extraire via scripts/extract_telegram_thread_ids.py)
TOPIC_CHAT_PROACTIVE_ID=2  # Topic ðŸ’¬ Chat & Proactive (DEFAULT)
TOPIC_EMAIL_ID=3  # Topic ðŸ“¬ Email & Communications
TOPIC_ACTIONS_ID=4  # Topic ðŸ¤– Actions & Validations
TOPIC_SYSTEM_ID=5  # Topic ðŸš¨ System & Alerts
TOPIC_METRICS_ID=6  # Topic ðŸ“Š Metrics & Logs

# ----------------------------------------------------------------------------
# EmailEngine (IMAP)
# ----------------------------------------------------------------------------
EMAILENGINE_HOST=http://emailengine:3000
EMAILENGINE_TOKEN=your_emailengine_token_here
# 4 comptes email configures via EmailEngine UI apres demarrage

# ----------------------------------------------------------------------------
# Google APIs (Calendar, Docs, Drive) - Post-MVP
# ----------------------------------------------------------------------------
GOOGLE_CLIENT_ID=your_google_client_id_here.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your_google_client_secret_here
GOOGLE_REDIRECT_URI=http://localhost:8000/auth/google/callback

# ----------------------------------------------------------------------------
# Presidio (Anonymisation RGPD)
# ----------------------------------------------------------------------------
PRESIDIO_ANALYZER_URL=http://presidio-analyzer:5001
PRESIDIO_ANONYMIZER_URL=http://presidio-anonymizer:5002
PRESIDIO_TIMEOUT=30  # Timeout appels Presidio (secondes)

# Note: Mapping ephemere en memoire uniquement Day 1 (AC3).
# Redis caching sera ajoute si besoin futur (batch processing).

# ----------------------------------------------------------------------------
# Observability & Trust Layer
# ----------------------------------------------------------------------------
TRUST_RETROGRADATION_THRESHOLD=0.90
TRUST_PROMOTION_THRESHOLD=0.95
TRUST_MIN_SAMPLE_SIZE=10
TRUST_ANTI_OSCILLATION_DAYS=14
NIGHTLY_METRICS_CRON=0 22 * * *
EVENING_SUMMARY_CRON=0 18 * * *

# ----------------------------------------------------------------------------
# Veille modele LLM (D18)
# ----------------------------------------------------------------------------
MODEL_BENCHMARK_CRON=0 3 1 * *  # 1er du mois a 3h
MODEL_ALERT_THRESHOLD_PCT=10    # Alerte si concurrent >10% superieur

# ----------------------------------------------------------------------------
# Monitoring
# ----------------------------------------------------------------------------
RAM_ALERT_THRESHOLD_PCT=85  # Alerte Telegram si depasse (VPS-4 48 Go)

# ----------------------------------------------------------------------------
# Tailscale
# ----------------------------------------------------------------------------
TAILSCALE_HOSTNAME=friday-vps
TAILSCALE_AUTH_KEY=tskey-auth-xxxxx  # Pour auto-join (optionnel)

# ----------------------------------------------------------------------------
# Syncthing (Sync VPS <-> PC)
# ----------------------------------------------------------------------------
SYNCTHING_API_KEY=your_syncthing_api_key_here
SYNCTHING_DEVICE_ID_VPS=XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX-XXXXXXX
SYNCTHING_DEVICE_ID_PC=YYYYYYY-YYYYYYY-YYYYYYY-YYYYYYY-YYYYYYY-YYYYYYY-YYYYYYY-YYYYYYY

# ----------------------------------------------------------------------------
# Chiffrement (age/SOPS)
# ----------------------------------------------------------------------------
SOPS_AGE_KEY_FILE=/config/sops-key.txt
AGE_PUBLIC_KEY=age1xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ----------------------------------------------------------------------------
# Logging
# ----------------------------------------------------------------------------
LOG_LEVEL=INFO
LOG_FORMAT=json

# ----------------------------------------------------------------------------
# Environment
# ----------------------------------------------------------------------------
ENVIRONMENT=development
DEBUG=false

# ----------------------------------------------------------------------------
# Backups
# ----------------------------------------------------------------------------
BACKUP_RETENTION_DAYS=7
BACKUP_PATH=/backups

# ----------------------------------------------------------------------------
# Development
# ----------------------------------------------------------------------------
HOT_RELOAD=true
PYTEST_ADDOPTS=-v --tb=short

# ============================================================================
# Notes
# ============================================================================
# 1. SOPS pour chiffrer : sops -e .env > .env.enc
# 2. Dechiffrer en production : sops -d .env.enc > .env
# 3. Budget estime : ~25 EUR VPS-4 + ~45 EUR Claude API + ~3 EUR veille = ~73 EUR/mois
# 4. VPS OVH VPS-4 : 48 Go RAM, 12 vCores, 300 Go SSD, ~25 EUR TTC/mois
