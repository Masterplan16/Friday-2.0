# Mis a jour 2026-02-10 : Story 1.13 ready-for-dev (6 bugs identifies, 22-31 tests requis, 5 AC manquent)
# generated: 2026-02-08
# project: Friday 2.0
# project_key: NOKEY
# tracking_system: file-system
# story_location: _bmad-output/implementation-artifacts

# STATUS DEFINITIONS:
# ==================
# Epic Status:
#   - backlog: Epic not yet started
#   - in-progress: Epic actively being worked on
#   - done: All stories in epic completed
#
# Epic Status Transitions:
#   - backlog → in-progress: Automatically when first story is created (via create-story)
#   - in-progress → done: Manually when all stories reach 'done' status
#
# Story Status:
#   - backlog: Story only exists in epic file
#   - ready-for-dev: Story file created in stories folder
#   - in-progress: Developer actively working on implementation
#   - review: Ready for code review (via Dev's code-review workflow)
#   - done: Story completed
#
# Retrospective Status:
#   - optional: Can be completed but not required
#   - done: Retrospective has been completed
#
# WORKFLOW NOTES:
# ===============
# - Epic transitions to 'in-progress' automatically when first story is created
# - Stories can be worked in parallel if team capacity allows
# - SM typically creates next story after previous one is 'done' to incorporate learnings
# - Dev moves story to 'review', then runs code-review (fresh context, different LLM recommended)

generated: 2026-02-08
project: Friday 2.0
project_key: NOKEY
tracking_system: file-system
story_location: _bmad-output/implementation-artifacts

development_status:
  # ────────────────────────────────────────────────────────────
  # SPRINT 1 — MVP Day 1 (Epics 1-7 | 45 stories | 82 FRs)
  # ────────────────────────────────────────────────────────────
  #
  # GRAPHE DE DÉPENDANCES:
  # ═══════════════════════
  # Epic 1 (DONE) ────┬─────> Epic 2 ──────┬────> Epic 3 ────┬────> Epic 4
  #                   │                     │                 │
  #                   │                     └────> Epic 7      │
  #                   │                                        │
  #                   └─────> Epic 6                           │
  #                   │                                        │
  #                   └──────────────────> (Epic 3) ──> Epic 5 ┘
  #
  # PHASES DE PARALLÉLISME:
  # ═══════════════════════
  #
  # PHASE 1 - MAINTENANT (Épics indépendants):
  #   Epic 2 (Email)   ═══════════════ } EN PARALLÈLE
  #   Epic 6 (Mémoire) ═══════════════ }
  #   Durée estimée: 2-3 semaines (Epic 2=L, Epic 6=L, 6.1 déjà done)
  #
  # PHASE 2 - Après Epic 2 terminé (Dépendants de Epic 2):
  #   Epic 3 (Archiviste) ════════════ } EN PARALLÈLE (possible)
  #   Epic 7 (Agenda)     ════════════ }
  #   Durée estimée: 2-3 semaines (Epic 3=L, Epic 7=M)
  #
  # PHASE 3 - Après Epic 3 terminé (Dépendant de Epic 3):
  #   Epic 5 (Vocal) ═════════════════
  #   Durée estimée: 1-2 semaines (Epic 5=M)
  #
  # PHASE 4 - Finale (Dépendant de Epic 2 + Epic 3):
  #   Epic 4 (Proactivité) ═══════════
  #   Durée estimée: 2-3 semaines (Epic 4=L)
  #
  # ────────────────────────────────────────────────────────────

  # Epic 1: Socle Operationnel & Controle (15 stories | 28 FRs)
  epic-1: done
  1-1-infrastructure-docker-compose: done
  1-2-schemas-postgresql-migrations: done  # 2026-02-09: Code review #2 (Opus 4.6) — 11 issues corriges, 111/111 tests, zero regression.
  1-3-fastapi-gateway-healthcheck: done  # 2026-02-09: Code review — 9 issues (3H, 4M, 2L) corrigees. 143/143 tests, flake8+mypy clean.
  1-4-tailscale-vpn-securite-reseau: done  # 2026-02-09: Code review — 12 issues (1H, 6M, 5L) corrigees. 181/181 tests, zero regression.
  1-5-presidio-anonymisation-fail-explicit: done  # 2026-02-09: Code review — 20 issues (3C, 4H, 9M, 4L), 16 fixed. AC1 enforced, tests smoke CI, 21 PII samples.
  1-6-trust-layer-middleware: done  # 2026-02-09: Code review complete - 15/15 issues fixed (3C+6H+6M), 20/20 tests pass, docs 650+ lines
  1-7-feedback-loop-correction-rules: done  # 2026-02-09: Code review Opus 4.6 completée - 15 issues fixées (6 CRITICAL, 5 HIGH, 4 MEDIUM). Tests complétés (17+ tests vs 2 triviaux), PII anonymisation ajoutée, documentation troubleshooting étendue. 9 fichiers modifiés.
  1-8-trust-metrics-retrogradation: done  # 2026-02-10: Code review complétée - 13 issues corrigés, 30/30 tests PASS ✅
  1-9-bot-telegram-core-topics: done  # 2026-02-09: COMPLETE - 22 bugs fixed, bot tested successfully, 7/7 ACs ✅, validation permissions corrected, Redis ACL TODO avant VPS prod
  1-10-bot-telegram-inline-buttons-validation: done  # 2026-02-10: Code review adversariale — 15 issues fixes (3C+5H+5M+2L), 34/34 tests, ActionExecutor C1, race condition C2, whitelist C3, status 'executed' H2, validated_by H4.
  1-11-commandes-telegram-trust-budget: done  # 2026-02-10: Code review adversariale — 15 issues fixes (3C+5H+5M+2L), 52/52 tests, pool asyncpg H1, owner check H5, RAM% C3, progressive disclosure M4
  1-12-backup-chiffre-sync-pc: done  # 2026-02-10: Code review adversarial - 15 issues fixés (4C+6H+5M). ImportError fix, /backup handler registered, SSH MITM fix, n8n JSON output, retry 9h, 5 unit tests, curl validation, portable find. 6/6 AC ✅, 28 fichiers.
  1-13-self-healing-tier-1-2: done  # 2026-02-10: CODE REVIEW COMPLETE ✅ - 8 issues fixés (1C+4M+3L), 6/6 AC ✅, 13/13 tasks, 28 tests (24 unit + 4 integration), 20 fichiers créés, 11 modifiés. Self-healing Tier 1-2: Docker restart, auto-recovery RAM (91%), OS updates, crash loop detection, error handler global. DB logging activé, tests telegram-notify ajoutés, paths configurables n8n.
  1-14-monitoring-docker-images: done  # 2026-02-10: CODE REVIEW ADVERSARIAL COMPLETE ✅ - 15 issues fixés (3C+5H+5M+2L), 4/4 AC ✅, 11 tests unit (10 PASS + 1 skip), 5 tests integration (mock+real), 1 test E2E étendu. Watchtower monitor-only, notifications Telegram, validation env vars, smoke tests CI. 5 fichiers créés, 4 modifiés. MONITOR_ONLY=true CRITIQUE verrouillé + tests notification mock ajoutés.
  1-15-cleanup-purge-rgpd: done  # 2026-02-10: CODE REVIEW ADVERSARIAL COMPLETE ✅ - 15 issues fixés (3C+5H+4M+3L), 6/6 AC ✅, cleanup automatisé RGPD (purge Presidio 30j, logs 7j, backups VPS 30j, transit 24h). Cron 03:05 quotidien, notifications Telegram System. Scripts portables (macOS/Linux), dry-run mode, error handling partial. 18 fichiers créés (migrations 022-023, scripts cleanup+deploy, tests unit+integration, docs spec 470 lignes). Timing coordination : 03:00 backup → 03:05 cleanup → 03:30 OS updates.
  1-16-ci-cd-pipeline-github-actions: done  # 2026-02-10: Code review completee - 17 issues fixees (3C+4H+6M+4L), AC8 logs JSON ajoutes, rollback intelligent, git pull safe, validation Telegram, subtasks 5.2-5.4 demarquees
  1-17-preparation-repository-public: done  # 2026-02-10: Code review adversarial - 13 issues fixes (4C+4H+3M+2L), 11/11 AC valides, 57/57 subtasks, PR #1 merged
  epic-1-retrospective: done  # 2026-02-11: Retrospective Epic 1 completee - 431 lignes, 17 stories analysees, learnings documentes

  # Epic 2: Pipeline Email Intelligent (7 stories | 10 FRs)
  epic-2: in-progress
  2-1-integration-emailengine-reception: done  # 2026-02-11: CODE REVIEW COMPLETE ✅ - 17 issues fixes (6C+5H+4M+2L), 55/55 tests PASS. EmailEngine v2.61.1 + webhooks (circuit breaker + rate limit) + consumer (retry backoff + DLQ + emails_raw chiffre + Telegram real). 7 AC valides, 30 fichiers (26+4 tests), docs 600+. Zero regressions.
  2-2-classification-email-llm: done  # 2026-02-11: CODE REVIEW COMPLETE ✅ - 15 issues fixés (3C+5H+4M+3L), 45/45 tests PASS + 7 skipped integration. Fixes: C1 RGPD anonymisation, C2 credentials warning, C3 race condition atomic UPDATE, H2 circuit breaker, H3 accuracy calculation, H4 type hints, H5 migration trigger validation, M1-M4 perf+logging+config+docs, L1-L3 imports+typo+optim. Claude Sonnet 4.5 classification, cold start tracking, 8 catégories, 21 fichiers créés (classifier, prompts, migration 026, tests), correction_rules injection, trust=propose Day 1.
  2-3-detection-vip-urgence: done  # 2026-02-11: COMPLETE ✅ - Tasks 1-4+7-8 (6/8 tasks MVP). VIP detector (compute_hash SHA256, detect_vip_sender @friday_action, 11 tests). Urgency detector multi-facteurs (VIP 0.5 + keywords 0.3 + deadline 0.2, seuil 0.6, 18 tests). Migrations 027-028 (vip_senders + urgency_keywords, 17 tests SQL). Models Pydantic (VIPSender + UrgencyResult, 18 tests). Dataset 31 emails + 5 tests E2E AC5 ✅ (100% recall VIP 12/12, 100% recall urgence 5/5, <10% faux positifs, latence <1s). Documentation README 400+ lignes. FIX DEFINITIF @friday_action **kwargs. TOTAL: 69 tests PASS (64 unit + 5 E2E). Task 5 (Telegram /vip) SKIPPED MVP. Task 6 (consumer integration) TODO. 28 fichiers créés/modifiés.
  2-4-extraction-pieces-jointes: backlog
  2-5-brouillon-reponse-email: backlog
  2-6-envoi-emails-approuves: backlog
  2-7-extraction-taches-depuis-emails: backlog
  epic-2-retrospective: optional

  # Epic 3: Archiviste & Recherche Documentaire (7 stories | 11 FRs)
  epic-3: backlog
  3-1-ocr-renommage-intelligent: backlog
  3-2-classement-arborescence: backlog
  3-3-recherche-semantique-documents: backlog
  3-4-suivi-garanties: backlog
  3-5-detection-nouveaux-fichiers: backlog
  3-6-fichiers-via-telegram: backlog
  3-7-traitement-batch-dossier: backlog
  epic-3-retrospective: optional

  # Epic 4: Intelligence Proactive & Briefings (7 stories | 8 FRs)
  epic-4: backlog
  4-1-heartbeat-engine-core: backlog
  4-2-briefing-matinal-8h: backlog
  4-3-digest-soir-18h: backlog
  4-4-rapport-hebdomadaire: backlog
  4-5-alertes-immediates-push: backlog
  4-6-agent-conversationnel-task-dispatcher: backlog  # 2026-02-11: Retour backlog (prématuré, Epic 1 prioritaire)
  4-7-task-management-commands-daily-briefing-integration: backlog  # 2026-02-11: Retour backlog (prématuré, Epic 1 prioritaire)
  epic-4-retrospective: optional

  # Epic 5: Interaction Vocale & Personnalite (4 stories | 4 FRs)
  epic-5: backlog
  5-1-stt-faster-whisper: backlog
  5-2-tts-kokoro: backlog
  5-3-recherche-vocale-documents: backlog
  5-4-personnalite-configurable: backlog
  epic-5-retrospective: optional

  # Epic 6: Memoire Eternelle & Migration (4 stories | 4 FRs)
  epic-6: in-progress
  6-1-graphe-connaissances-postgresql: done  # 2026-02-11: CODE REVIEW COMPLETE ✅ - PostgreSQL knowledge graph avec pgvector (D19). Migration 007-008, schema knowledge.*, embeddings vector(1024) + HNSW index, memorystore.py adaptateur complet, graph_populator.py, 10 NodeType + 14 RelationType enums validés. Tests unitaires 19/19 PASS. Decision D19: pgvector Day 1 (pas Qdrant), réévaluation si >300k vecteurs. 12 fichiers créés/modifiés.
  6-2-embeddings-pgvector: done  # 2026-02-11: STORY COMPLETE ✅ - Voyage AI voyage-4-large + pgvector. AC1-7 TOUS COMPLETS ✅. 36 tests PASS (25 unit + 9 integration + 2 E2E). AC6: Budget tracking (migration 025, monitoring, alertes Telegram). AC7: Tests PostgreSQL réels + E2E pipeline Email→Embedding→Search. Code review: 12 issues, 11 fixed. Contamination cross-story résolue (2 PRs séparées #28/#29). Code quality: EXCELLENT. 13 fichiers créés/modifiés (2 commits).
  6-3-adaptateur-memorystore: done  # 2026-02-11: CODE REVIEW COMPLETE ✅ - 15 issues fixés (3C+5H+4M+3L). Interface abstraite MemoryStore(ABC) 429 lignes + PostgreSQLMemorystore renommé + factory multi-provider (stubs Graphiti/Neo4j/Qdrant). Tests 11/11 interface PASS + 19/19 existants PASS (zero régression). Coverage 83% interface, 100% factory. Doc migration 540 lignes + Mermaid. Pattern cohérent vectorstore.py. Effort 12h. 3 fichiers créés, 8 modifiés.
  6-4-migration-emails-historiques: in-progress  # 2026-02-11: Story créée - Migration 110k emails historiques (PG classification + graph + embeddings). 3 phases ($173 budget réaliste vs $45 PRD), 28h dev + 30-37h runtime. 8 bugs identifiés (4C), Presidio stub critical. Dépend: 6.1/6.2/6.3 done. 6 AC, 30+ subtasks.
  epic-6-retrospective: optional

  # Epic 7: Agenda & Calendrier Multi-casquettes (3 stories | 4 FRs)
  epic-7: backlog
  7-1-detection-evenements: backlog
  7-2-sync-google-calendar: backlog
  7-3-multi-casquettes-conflits: backlog
  epic-7-retrospective: optional

  # ────────────────────────────────────────────────────────────
  # SPRINT 2 — Growth Month 1-3 (Epics 8-13 | 22 stories | 33 FRs)
  # Prerequis: Sprint 1 stable >= 1 semaine
  # ────────────────────────────────────────────────────────────

  # Epic 8: Suivi Financier & Detection Anomalies (5 stories | 10 FRs)
  epic-8: backlog
  8-1-import-classification-bancaire: backlog
  8-2-suivi-depenses-tresorerie: backlog
  8-3-detection-anomalies-financieres: backlog
  8-4-audit-abonnements: backlog
  8-5-export-comptable-factures: backlog
  epic-8-retrospective: optional

  # Epic 9: Tuteur & Superviseur de Theses (4 stories | 9 FRs)
  epic-9: backlog
  9-1-integration-google-docs-api: backlog
  9-2-analyse-methodologique-these: backlog
  9-3-anti-hallucination-references: backlog
  9-4-completion-bibliographique: backlog
  epic-9-retrospective: optional

  # Epic 10: Veilleur Droit (3 stories | 6 FRs)
  epic-10: backlog
  10-1-analyse-contrat-demande: backlog
  10-2-detection-clauses-abusives: backlog
  10-3-rappels-renouvellement: backlog
  epic-10-retrospective: optional

  # Epic 11: Plaud Note & Transcriptions (4 stories | 7 FRs)
  epic-11: backlog
  11-1-integration-plaud-transcription: backlog
  11-2-compte-rendu-structure: backlog
  11-3-extraction-routage-cascade: backlog
  11-4-lien-plaud-bibliographie: backlog
  epic-11-retrospective: optional

  # Epic 12: Self-Healing Avance Tier 3-4 (3 stories | 4 FRs)
  epic-12: backlog
  12-1-detection-connecteurs-externes: backlog
  12-2-detection-drift-accuracy: backlog
  12-3-patterns-degradation-alertes: backlog
  epic-12-retrospective: optional

  # Epic 13: Gouvernance & Veille Modele IA (3 stories | 5 FRs)
  epic-13: backlog
  13-1-benchmark-mensuel-automatise: backlog
  13-2-metriques-llm-modele: backlog
  13-3-cost-aware-routing-migration: backlog
  epic-13-retrospective: optional

  # ────────────────────────────────────────────────────────────
  # SPRINT 3 — Vision 3+ mois (Epics 14-20 | 26 stories | 36 FRs)
  # Prerequis: Sprint 1 + Sprint 2 stables
  # ────────────────────────────────────────────────────────────

  # Epic 14: Aide en Consultation Medicale (6 stories | 10 FRs) — trust=blocked
  epic-14: backlog
  14-1-interpretation-ecg: backlog
  14-2-interactions-medicamenteuses: backlog
  14-3-recommandations-has-posologies: backlog
  14-4-rappels-suivi-patients: backlog
  14-5-automatisation-doctolib: backlog
  14-6-coach-medical-trust-blocked: backlog
  epic-14-retrospective: optional

  # Epic 15: Menus, Courses & Coach (4 stories | 7 FRs)
  epic-15: backlog
  15-1-planification-menus: backlog
  15-2-liste-courses: backlog
  15-3-recettes-jour: backlog
  15-4-programme-sportif: backlog
  epic-15-retrospective: optional

  # Epic 16: Entretien Cyclique & Rappels (2 stories | 3 FRs)
  epic-16: backlog
  16-1-suivi-cycles-entretien: backlog
  16-2-rappels-proactifs: backlog
  epic-16-retrospective: optional

  # Epic 17: Enseignement Medical TCS/ECOS/Cours (4 stories | 6 FRs)
  epic-17: backlog
  17-1-indexation-programme-etudes: backlog
  17-2-generateur-tcs: backlog
  17-3-generateur-ecos: backlog
  17-4-actualisateur-cours: backlog
  epic-17-retrospective: optional

  # Epic 18: Gestion Personnelle Photos/JV/CV/HS (7 stories | 13 FRs)
  epic-18: backlog
  18-1-indexation-photos: backlog
  18-2-recherche-photos: backlog
  18-3-inventaire-jv: backlog
  18-4-veille-prix-valeur: backlog
  18-5-document-assurance: backlog
  18-6-cv-academique-auto: backlog
  18-7-mode-hs-vacances: backlog
  epic-18-retrospective: optional

  # Epic 19: Optimisation Fiscale & Investissement (2 stories | 3 FRs)
  epic-19: backlog
  19-1-aide-decision-achat: backlog
  19-2-optimisation-fiscale: backlog
  epic-19-retrospective: optional

  # Epic 20: Evolution Graphe de Connaissances (1 story | decision)
  epic-20: backlog
  20-1-evaluation-technique-graphiti-neo4j: backlog
  epic-20-retrospective: optional
